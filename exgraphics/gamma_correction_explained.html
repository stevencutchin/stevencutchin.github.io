<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamma Correction - Visual Explanation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .header p {
            font-size: 1.3em;
            opacity: 0.95;
            line-height: 1.6;
        }
        
        .content {
            padding: 40px;
        }
        
        .section {
            margin-bottom: 50px;
            background: #f8f9fa;
            border-radius: 12px;
            padding: 35px;
            border-left: 6px solid #667eea;
        }
        
        .section h2 {
            color: #667eea;
            margin-bottom: 25px;
            font-size: 2em;
        }
        
        .section h3 {
            color: #764ba2;
            margin: 25px 0 15px 0;
            font-size: 1.5em;
        }
        
        svg {
            width: 100%;
            height: auto;
            border-radius: 8px;
            background: white;
        }
        
        .note {
            background: #d1ecf1;
            border: 2px solid #bee5eb;
            border-radius: 8px;
            padding: 20px;
            margin: 25px 0;
            color: #0c5460;
            line-height: 1.8;
        }
        
        .note strong {
            display: block;
            margin-bottom: 8px;
            font-size: 1.1em;
        }
        
        .key-fact {
            background: #d4edda;
            border: 2px solid #c3e6cb;
            color: #155724;
        }
        
        .warning-note {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
        }
        
        .formula-box {
            background: white;
            border: 3px solid #667eea;
            border-radius: 8px;
            padding: 25px;
            margin: 25px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.2em;
            text-align: center;
        }
        
        .formula-box .label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 10px;
            font-family: 'Segoe UI', sans-serif;
        }
        
        .code-section {
            background: #282c34;
            color: #abb2bf;
            padding: 30px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 0.95em;
            line-height: 1.6;
            margin: 25px 0;
        }
        
        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }
        
        .comparison-item {
            background: white;
            border-radius: 8px;
            padding: 20px;
            border: 2px solid #e0e0e0;
        }
        
        .comparison-item h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.2em;
        }
        
        .interactive-slider {
            margin: 30px 0;
            padding: 25px;
            background: white;
            border-radius: 8px;
            border: 2px solid #667eea;
        }
        
        .slider-container {
            margin: 20px 0;
        }
        
        .slider-container label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }
        
        .slider-container input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }
        
        .slider-container input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
        }
        
        .slider-container input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            border: none;
        }
        
        .value-display {
            display: inline-block;
            background: #667eea;
            color: white;
            padding: 5px 15px;
            border-radius: 5px;
            font-weight: bold;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé® Gamma Correction</h1>
            <p>Understanding Non-Linear Color Encoding for Accurate Display</p>
            <p style="font-size: 1em; margin-top: 10px;">Why your graphics need gamma correction to look right</p>
        </div>
        
        <div class="content">
            <!-- Problem Statement -->
            <div class="section">
                <h2>üéØ The Problem: Why We Need Gamma Correction</h2>
                
                <p style="line-height: 1.8; margin-bottom: 25px;">
                    Imagine you're rendering a 3D scene where you calculate that a surface should receive 50% of the maximum light intensity. You might think setting the color to (0.5, 0.5, 0.5) would display 50% brightness on screen. <strong>You'd be wrong.</strong> Due to the way monitors work, that would actually appear much darker than 50% brightness to your eye. This is the core problem gamma correction solves.
                </p>

                <svg viewBox="0 0 1200 500" xmlns="http://www.w3.org/2000/svg">
                    <!-- Background -->
                    <rect width="1200" height="500" fill="#f8f9fa"/>
                    
                    <!-- Title -->
                    <text x="600" y="35" font-size="24" font-weight="bold" fill="#333" text-anchor="middle">The Problem: Linear Light ‚â† Linear Display</text>
                    
                    <!-- Left side: What you calculate -->
                    <g transform="translate(100, 80)">
                        <rect x="0" y="0" width="400" height="380" fill="white" stroke="#667eea" stroke-width="3" rx="8"/>
                        <text x="200" y="30" font-size="18" font-weight="bold" fill="#667eea" text-anchor="middle">What You Calculate (Linear Light)</text>
                        
                        <!-- Gradient bars showing linear progression -->
                        <rect x="50" y="60" width="60" height="80" fill="rgb(0,0,0)"/>
                        <text x="80" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">0.0</text>
                        <text x="80" y="170" font-size="11" fill="#666" text-anchor="middle">0%</text>
                        
                        <rect x="120" y="60" width="60" height="80" fill="rgb(64,64,64)"/>
                        <text x="150" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">0.25</text>
                        <text x="150" y="170" font-size="11" fill="#666" text-anchor="middle">25%</text>
                        
                        <rect x="190" y="60" width="60" height="80" fill="rgb(128,128,128)"/>
                        <text x="220" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">0.5</text>
                        <text x="220" y="170" font-size="11" fill="#666" text-anchor="middle">50%</text>
                        
                        <rect x="260" y="60" width="60" height="80" fill="rgb(191,191,191)"/>
                        <text x="290" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">0.75</text>
                        <text x="290" y="170" font-size="11" fill="#666" text-anchor="middle">75%</text>
                        
                        <rect x="330" y="60" width="60" height="80" fill="rgb(255,255,255)"/>
                        <text x="360" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">1.0</text>
                        <text x="360" y="170" font-size="11" fill="#666" text-anchor="middle">100%</text>
                        
                        <!-- Graph showing linear relationship -->
                        <line x1="50" y1="320" x2="390" y2="320" stroke="#333" stroke-width="2"/>
                        <line x1="50" y1="200" x2="50" y2="320" stroke="#333" stroke-width="2"/>
                        
                        <text x="45" y="205" font-size="12" fill="#666" text-anchor="end">1.0</text>
                        <text x="45" y="265" font-size="12" fill="#666" text-anchor="end">0.5</text>
                        <text x="45" y="325" font-size="12" fill="#666" text-anchor="end">0.0</text>
                        
                        <!-- Linear line -->
                        <line x1="50" y1="320" x2="390" y2="200" stroke="#4caf50" stroke-width="4"/>
                        <circle cx="50" cy="320" r="6" fill="#4caf50"/>
                        <circle cx="135" cy="290" r="6" fill="#4caf50"/>
                        <circle cx="220" cy="260" r="6" fill="#4caf50"/>
                        <circle cx="305" cy="230" r="6" fill="#4caf50"/>
                        <circle cx="390" cy="200" r="6" fill="#4caf50"/>
                        
                        <text x="220" y="350" font-size="13" fill="#4caf50" text-anchor="middle" font-weight="bold">Linear Response</text>
                        <text x="220" y="365" font-size="11" fill="#666" text-anchor="middle">(Physically correct lighting)</text>
                    </g>
                    
                    <!-- Arrow -->
                    <defs>
                        <marker id="arrow" markerWidth="12" markerHeight="12" refX="11" refY="4" orient="auto">
                            <polygon points="0 0, 12 4, 0 8" fill="#e74c3c" />
                        </marker>
                    </defs>
                    <line x1="530" y1="270" x2="640" y2="270" stroke="#e74c3c" stroke-width="4" marker-end="url(#arrow)"/>
                    <text x="585" y="255" font-size="16" fill="#e74c3c" text-anchor="middle" font-weight="bold">Display</text>
                    <text x="585" y="300" font-size="13" fill="#e74c3c" text-anchor="middle">Œ≥ ‚âà 2.2</text>
                    
                    <!-- Right side: What actually displays -->
                    <g transform="translate(670, 80)">
                        <rect x="0" y="0" width="400" height="380" fill="white" stroke="#e74c3c" stroke-width="3" rx="8"/>
                        <text x="200" y="30" font-size="18" font-weight="bold" fill="#e74c3c" text-anchor="middle">What Actually Displays (Too Dark!)</text>
                        
                        <!-- Gradient bars showing what actually displays (darker) -->
                        <rect x="50" y="60" width="60" height="80" fill="rgb(0,0,0)"/>
                        <text x="80" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">0.0</text>
                        <text x="80" y="170" font-size="11" fill="#666" text-anchor="middle">0%</text>
                        
                        <rect x="120" y="60" width="60" height="80" fill="rgb(14,14,14)"/>
                        <text x="150" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">0.05</text>
                        <text x="150" y="170" font-size="11" fill="#e74c3c" text-anchor="middle">5% ‚ö†Ô∏è</text>
                        
                        <rect x="190" y="60" width="60" height="80" fill="rgb(55,55,55)"/>
                        <text x="220" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">0.22</text>
                        <text x="220" y="170" font-size="11" fill="#e74c3c" text-anchor="middle">22% ‚ö†Ô∏è</text>
                        
                        <rect x="260" y="60" width="60" height="80" fill="rgb(122,122,122)"/>
                        <text x="290" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">0.52</text>
                        <text x="290" y="170" font-size="11" fill="#e74c3c" text-anchor="middle">52% ‚ö†Ô∏è</text>
                        
                        <rect x="330" y="60" width="60" height="80" fill="rgb(255,255,255)"/>
                        <text x="360" y="155" font-size="14" fill="#333" text-anchor="middle" font-weight="bold">1.0</text>
                        <text x="360" y="170" font-size="11" fill="#666" text-anchor="middle">100%</text>
                        
                        <!-- Graph showing gamma curve -->
                        <line x1="50" y1="320" x2="390" y2="320" stroke="#333" stroke-width="2"/>
                        <line x1="50" y1="200" x2="50" y2="320" stroke="#333" stroke-width="2"/>
                        
                        <text x="45" y="205" font-size="12" fill="#666" text-anchor="end">1.0</text>
                        <text x="45" y="265" font-size="12" fill="#666" text-anchor="end">0.5</text>
                        <text x="45" y="325" font-size="12" fill="#666" text-anchor="end">0.0</text>
                        
                        <!-- Gamma curve (darkening) -->
                        <path d="M 50,320 Q 120,315 220,280 T 390,200" 
                              fill="none" stroke="#e74c3c" stroke-width="4"/>
                        <circle cx="50" cy="320" r="6" fill="#e74c3c"/>
                        <circle cx="135" cy="310" r="6" fill="#e74c3c"/>
                        <circle cx="220" cy="280" r="6" fill="#e74c3c"/>
                        <circle cx="305" cy="240" r="6" fill="#e74c3c"/>
                        <circle cx="390" cy="200" r="6" fill="#e74c3c"/>
                        
                        <text x="220" y="350" font-size="13" fill="#e74c3c" text-anchor="middle" font-weight="bold">Gamma Curve (Œ≥ = 2.2)</text>
                        <text x="220" y="365" font-size="11" fill="#666" text-anchor="middle">(Display's non-linear response)</text>
                    </g>
                </svg>
                
                <div class="warning-note">
                    <strong>‚ö†Ô∏è The Core Issue:</strong>
                    When you send 0.5 (50% intensity) to a monitor, it displays at roughly 22% actual brightness due to the monitor's gamma response curve (Œ≥ ‚âà 2.2). This means your carefully calculated lighting looks way too dark! Midtones become shadows, and only the brightest colors look correct.
                </div>
            </div>

            <!-- The Science Behind It -->
            <div class="section">
                <h2>üî¨ The Science: Why Monitors Are Non-Linear</h2>
                
                <h3>Historical Context: CRT Technology</h3>
                <p style="line-height: 1.8; margin-bottom: 25px;">
                    The gamma curve isn't arbitrary - it originated from the physics of CRT (cathode ray tube) monitors. In a CRT, electrons are accelerated to strike phosphors on the screen. The relationship between the input voltage and the light output follows a power law approximately equal to V<sup>2.2</sup>. This became the de facto standard, and even though we now use LCD and OLED displays, they're designed to mimic this behavior for backward compatibility.
                </p>

                <svg viewBox="0 0 1200 700" xmlns="http://www.w3.org/2000/svg">
                    <!-- Background -->
                    <rect width="1200" height="700" fill="white"/>
                    
                    <!-- Title -->
                    <text x="600" y="35" font-size="24" font-weight="bold" fill="#333" text-anchor="middle">Monitor Gamma Response Curve</text>
                    
                    <!-- Main graph -->
                    <g transform="translate(150, 80)">
                        <!-- Axes -->
                        <line x1="0" y1="500" x2="900" y2="500" stroke="#333" stroke-width="3"/>
                        <line x1="0" y1="0" x2="0" y2="500" stroke="#333" stroke-width="3"/>
                        
                        <!-- Axis labels -->
                        <text x="450" y="545" font-size="18" fill="#333" text-anchor="middle" font-weight="bold">Input Value (What You Send)</text>
                        <text x="-250" y="20" font-size="18" fill="#333" text-anchor="middle" font-weight="bold" transform="rotate(-90 -250 20)">Output Brightness (What You See)</text>
                        
                        <!-- Grid lines -->
                        <g opacity="0.3">
                            <line x1="0" y1="400" x2="900" y2="400" stroke="#999" stroke-width="1" stroke-dasharray="5,5"/>
                            <line x1="0" y1="300" x2="900" y2="300" stroke="#999" stroke-width="1" stroke-dasharray="5,5"/>
                            <line x1="0" y1="200" x2="900" y2="200" stroke="#999" stroke-width="1" stroke-dasharray="5,5"/>
                            <line x1="0" y1="100" x2="900" y2="100" stroke="#999" stroke-width="1" stroke-dasharray="5,5"/>
                            
                            <line x1="225" y1="0" x2="225" y2="500" stroke="#999" stroke-width="1" stroke-dasharray="5,5"/>
                            <line x1="450" y1="0" x2="450" y2="500" stroke="#999" stroke-width="1" stroke-dasharray="5,5"/>
                            <line x1="675" y1="0" x2="675" y2="500" stroke="#999" stroke-width="1" stroke-dasharray="5,5"/>
                        </g>
                        
                        <!-- Tick marks and labels -->
                        <g id="x-axis-labels">
                            <line x1="0" y1="500" x2="0" y2="510" stroke="#333" stroke-width="2"/>
                            <text x="0" y="530" font-size="14" fill="#666" text-anchor="middle">0.0</text>
                            
                            <line x1="225" y1="500" x2="225" y2="510" stroke="#333" stroke-width="2"/>
                            <text x="225" y="530" font-size="14" fill="#666" text-anchor="middle">0.25</text>
                            
                            <line x1="450" y1="500" x2="450" y2="510" stroke="#333" stroke-width="2"/>
                            <text x="450" y="530" font-size="14" fill="#666" text-anchor="middle">0.5</text>
                            
                            <line x1="675" y1="500" x2="675" y2="510" stroke="#333" stroke-width="2"/>
                            <text x="675" y="530" font-size="14" fill="#666" text-anchor="middle">0.75</text>
                            
                            <line x1="900" y1="500" x2="900" y2="510" stroke="#333" stroke-width="2"/>
                            <text x="900" y="530" font-size="14" fill="#666" text-anchor="middle">1.0</text>
                        </g>
                        
                        <g id="y-axis-labels">
                            <line x1="-10" y1="500" x2="0" y2="500" stroke="#333" stroke-width="2"/>
                            <text x="-15" y="505" font-size="14" fill="#666" text-anchor="end">0.0</text>
                            
                            <line x1="-10" y1="400" x2="0" y2="400" stroke="#333" stroke-width="2"/>
                            <text x="-15" y="405" font-size="14" fill="#666" text-anchor="end">0.2</text>
                            
                            <line x1="-10" y1="300" x2="0" y2="300" stroke="#333" stroke-width="2"/>
                            <text x="-15" y="305" font-size="14" fill="#666" text-anchor="end">0.4</text>
                            
                            <line x1="-10" y1="200" x2="0" y2="200" stroke="#333" stroke-width="2"/>
                            <text x="-15" y="205" font-size="14" fill="#666" text-anchor="end">0.6</text>
                            
                            <line x1="-10" y1="100" x2="0" y2="100" stroke="#333" stroke-width="2"/>
                            <text x="-15" y="105" font-size="14" fill="#666" text-anchor="end">0.8</text>
                            
                            <line x1="-10" y1="0" x2="0" y2="0" stroke="#333" stroke-width="2"/>
                            <text x="-15" y="5" font-size="14" fill="#666" text-anchor="end">1.0</text>
                        </g>
                        
                        <!-- Linear reference line -->
                        <line x1="0" y1="500" x2="900" y2="0" stroke="#4caf50" stroke-width="3" stroke-dasharray="10,5"/>
                        <text x="750" y="130" font-size="16" fill="#4caf50" font-weight="bold">Linear (Œ≥ = 1.0)</text>
                        <text x="750" y="150" font-size="13" fill="#4caf50">(Ideal response)</text>
                        
                        <!-- Gamma 2.2 curve (typical monitor) -->
                        <path d="M 0,500 
                                 Q 100,495 225,455
                                 T 450,320
                                 T 675,140
                                 T 900,0"
                              fill="none" stroke="#e74c3c" stroke-width="5"/>
                        
                        <!-- Key points on gamma curve -->
                        <circle cx="0" cy="500" r="8" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                        <circle cx="225" cy="455" r="8" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                        <circle cx="450" cy="320" r="8" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                        <circle cx="675" cy="140" r="8" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                        <circle cx="900" cy="0" r="8" fill="#e74c3c" stroke="#c0392b" stroke-width="2"/>
                        
                        <text x="520" y="330" font-size="16" fill="#e74c3c" font-weight="bold">Monitor Gamma (Œ≥ = 2.2)</text>
                        <text x="520" y="350" font-size="13" fill="#e74c3c">(Typical display response)</text>
                        
                        <!-- Annotation showing the problem at 0.5 -->
                        <line x1="450" y1="500" x2="450" y2="320" stroke="#ff9800" stroke-width="3" stroke-dasharray="8,4"/>
                        <text x="460" y="410" font-size="15" fill="#ff9800" font-weight="bold">Input: 0.5</text>
                        
                        <line x1="0" y1="320" x2="450" y2="320" stroke="#ff9800" stroke-width="3" stroke-dasharray="8,4"/>
                        <text x="200" y="310" font-size="15" fill="#ff9800" font-weight="bold">Output: ~0.22</text>
                        
                        <!-- Formula box -->
                        <rect x="600" y="380" width="280" height="100" fill="#fff3cd" stroke="#ffc107" stroke-width="3" rx="8"/>
                        <text x="740" y="410" font-size="16" fill="#856404" text-anchor="middle" font-weight="bold">Display Formula:</text>
                        <text x="740" y="435" font-size="18" fill="#856404" text-anchor="middle" font-family="'Courier New', monospace">Output = Input<tspan font-size="14" baseline-shift="super">2.2</tspan></text>
                        <text x="740" y="460" font-size="13" fill="#856404" text-anchor="middle">where Œ≥ = 2.2</text>
                    </g>
                </svg>
                
                <div class="key-fact">
                    <strong>üí° The Gamma Value:</strong>
                    The exponent in the power law (Œ≥ = 2.2) is called the "gamma" value. It describes how non-linear the display is. A gamma of 1.0 would be perfectly linear (ideal), but real monitors use Œ≥ ‚âà 2.2 for standard RGB (sRGB) or Œ≥ ‚âà 2.4 for some professional displays. The exact formula is: <strong>Display_Output = (Input_Value)<sup>Œ≥</sup></strong>
                </div>
            </div>

            <!-- The Solution -->
            <div class="section">
                <h2>‚úÖ The Solution: Gamma Encoding</h2>
                
                <p style="line-height: 1.8; margin-bottom: 25px;">
                    To compensate for the monitor's gamma response, we apply the <strong>inverse</strong> transformation before sending colors to the display. This is called <strong>gamma encoding</strong> or <strong>gamma correction</strong>. By pre-brightening our linear colors with a 1/2.2 curve, they display at the correct brightness when the monitor applies its 2.2 curve.
                </p>

                <svg viewBox="0 0 1400 600" xmlns="http://www.w3.org/2000/svg">
                    <!-- Background -->
                    <rect width="1400" height="600" fill="white"/>
                    
                    <!-- Title -->
                    <text x="700" y="35" font-size="24" font-weight="bold" fill="#333" text-anchor="middle">The Complete Gamma Correction Pipeline</text>
                    
                    <!-- Step 1: Linear calculation -->
                    <g transform="translate(50, 80)">
                        <rect x="0" y="0" width="280" height="180" fill="#e8f5e9" stroke="#4caf50" stroke-width="3" rx="8"/>
                        <text x="140" y="30" font-size="18" font-weight="bold" fill="#2e7d32" text-anchor="middle">1. Linear Calculation</text>
                        <text x="140" y="60" font-size="14" fill="#333" text-anchor="middle">(Your shader computes)</text>
                        
                        <rect x="40" y="80" width="200" height="60" fill="white" stroke="#4caf50" stroke-width="2" rx="5"/>
                        <text x="140" y="110" font-size="16" fill="#333" text-anchor="middle" font-family="'Courier New', monospace">color = vec3(0.5)</text>
                        <text x="140" y="130" font-size="13" fill="#666" text-anchor="middle">(50% physical light)</text>
                        
                        <text x="140" y="165" font-size="13" fill="#2e7d32" font-weight="bold" text-anchor="middle">Physically accurate!</text>
                    </g>
                    
                    <!-- Arrow 1 -->
                    <defs>
                        <marker id="arrow-blue" markerWidth="12" markerHeight="12" refX="11" refY="4" orient="auto">
                            <polygon points="0 0, 12 4, 0 8" fill="#2196f3" />
                        </marker>
                    </defs>
                    <line x1="340" y1="170" x2="420" y2="170" stroke="#2196f3" stroke-width="4" marker-end="url(#arrow-blue)"/>
                    
                    <!-- Step 2: Gamma encoding -->
                    <g transform="translate(430, 80)">
                        <rect x="0" y="0" width="280" height="180" fill="#e3f2fd" stroke="#2196f3" stroke-width="3" rx="8"/>
                        <text x="140" y="30" font-size="18" font-weight="bold" fill="#1565c0" text-anchor="middle">2. Gamma Encoding</text>
                        <text x="140" y="60" font-size="14" fill="#333" text-anchor="middle">(Apply before display)</text>
                        
                        <rect x="20" y="75" width="240" height="70" fill="white" stroke="#2196f3" stroke-width="2" rx="5"/>
                        <text x="140" y="105" font-size="15" fill="#333" text-anchor="middle" font-family="'Courier New', monospace">encoded = pow(color, 1/2.2)</text>
                        <text x="140" y="125" font-size="15" fill="#333" text-anchor="middle" font-family="'Courier New', monospace">= pow(0.5, 0.4545)</text>
                        <text x="140" y="140" font-size="15" fill="#333" text-anchor="middle" font-family="'Courier New', monospace">‚âà 0.73</text>
                        
                        <text x="140" y="165" font-size="13" fill="#1565c0" font-weight="bold" text-anchor="middle">Pre-brighten the value!</text>
                    </g>
                    
                    <!-- Arrow 2 -->
                    <line x1="720" y1="170" x2="800" y2="170" stroke="#ff9800" stroke-width="4" marker-end="url(#arrow-orange)"/>
                    <defs>
                        <marker id="arrow-orange" markerWidth="12" markerHeight="12" refX="11" refY="4" orient="auto">
                            <polygon points="0 0, 12 4, 0 8" fill="#ff9800" />
                        </marker>
                    </defs>
                    
                    <!-- Step 3: Monitor applies gamma -->
                    <g transform="translate(810, 80)">
                        <rect x="0" y="0" width="280" height="180" fill="#fff3e0" stroke="#ff9800" stroke-width="3" rx="8"/>
                        <text x="140" y="30" font-size="18" font-weight="bold" fill="#e65100" text-anchor="middle">3. Monitor Gamma</text>
                        <text x="140" y="60" font-size="14" fill="#333" text-anchor="middle">(Display applies Œ≥=2.2)</text>
                        
                        <rect x="20" y="75" width="240" height="70" fill="white" stroke="#ff9800" stroke-width="2" rx="5"/>
                        <text x="140" y="105" font-size="15" fill="#333" text-anchor="middle" font-family="'Courier New', monospace">displayed = pow(0.73, 2.2)</text>
                        <text x="140" y="125" font-size="15" fill="#333" text-anchor="middle" font-family="'Courier New', monospace">‚âà 0.5</text>
                        
                        <text x="140" y="165" font-size="13" fill="#e65100" font-weight="bold" text-anchor="middle">Back to 50% brightness! ‚úì</text>
                    </g>
                    
                    <!-- Bottom: Visual comparison -->
                    <g transform="translate(50, 320)">
                        <text x="650" y="0" font-size="20" font-weight="bold" fill="#333" text-anchor="middle">Visual Result Comparison</text>
                        
                        <!-- Without gamma correction -->
                        <rect x="50" y="30" width="500" height="200" fill="white" stroke="#e74c3c" stroke-width="3" rx="8"/>
                        <text x="300" y="60" font-size="16" font-weight="bold" fill="#e74c3c" text-anchor="middle">‚ùå Without Gamma Correction</text>
                        
                        <rect x="100" y="80" width="80" height="80" fill="rgb(128,128,128)" stroke="#333" stroke-width="2"/>
                        <text x="140" y="175" font-size="13" fill="#333" text-anchor="middle" font-weight="bold">Sent: 0.5</text>
                        
                        <text x="200" y="125" font-size="30" fill="#333" text-anchor="middle">‚Üí</text>
                        
                        <rect x="240" y="80" width="80" height="80" fill="rgb(55,55,55)" stroke="#333" stroke-width="2"/>
                        <text x="280" y="175" font-size="13" fill="#e74c3c" text-anchor="middle" font-weight="bold">Displays: 0.22</text>
                        
                        <text x="360" y="125" font-size="24" fill="#e74c3c" text-anchor="middle">‚ö†Ô∏è</text>
                        
                        <text x="435" y="125" font-size="14" fill="#e74c3c" text-anchor="middle" font-weight="bold">Too dark!</text>
                        
                        <!-- With gamma correction -->
                        <rect x="650" y="30" width="500" height="200" fill="white" stroke="#4caf50" stroke-width="3" rx="8"/>
                        <text x="900" y="60" font-size="16" font-weight="bold" fill="#4caf50" text-anchor="middle">‚úì With Gamma Correction</text>
                        
                        <rect x="700" y="80" width="80" height="80" fill="rgb(186,186,186)" stroke="#333" stroke-width="2"/>
                        <text x="740" y="175" font-size="13" fill="#333" text-anchor="middle" font-weight="bold">Sent: 0.73</text>
                        
                        <text x="800" y="125" font-size="30" fill="#333" text-anchor="middle">‚Üí</text>
                        
                        <rect x="840" y="80" width="80" height="80" fill="rgb(128,128,128)" stroke="#333" stroke-width="2"/>
                        <text x="880" y="175" font-size="13" fill="#4caf50" text-anchor="middle" font-weight="bold">Displays: 0.5</text>
                        
                        <text x="960" y="125" font-size="24" fill="#4caf50" text-anchor="middle">‚úì</text>
                        
                        <text x="1035" y="125" font-size="14" fill="#4caf50" text-anchor="middle" font-weight="bold">Perfect!</text>
                    </g>
                </svg>
                
                <div class="formula-box">
                    <div class="label">Gamma Encoding Formula (Apply in Shader):</div>
                    <div style="color: #2196f3; margin: 15px 0;">
                        encoded_color = pow(linear_color, 1.0 / 2.2)
                    </div>
                    <div class="label">Simplified as:</div>
                    <div style="color: #2196f3; margin: 15px 0;">
                        encoded_color = pow(linear_color, 0.4545)
                    </div>
                </div>
            </div>

            <!-- Interactive Demo -->
            <div class="section">
                <h2>üéÆ Interactive Gamma Correction Demo</h2>
                
                <div class="interactive-slider">
                    <h3 style="margin-bottom: 20px; color: #667eea;">Adjust Linear Input Value</h3>
                    
                    <div class="slider-container">
                        <label>Linear Light Value: <span class="value-display" id="linear-value">0.50</span></label>
                        <input type="range" id="linear-slider" min="0" max="100" value="50" step="1">
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-top: 30px;">
                        <div style="text-align: center;">
                            <div style="font-weight: bold; margin-bottom: 10px; color: #4caf50;">Linear Value</div>
                            <div id="linear-box" style="width: 100%; height: 120px; background: rgb(128,128,128); border: 3px solid #4caf50; border-radius: 8px;"></div>
                            <div id="linear-label" style="margin-top: 10px; font-size: 14px;">RGB(128, 128, 128)</div>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="font-weight: bold; margin-bottom: 10px; color: #2196f3;">Gamma Encoded</div>
                            <div id="encoded-box" style="width: 100%; height: 120px; background: rgb(186,186,186); border: 3px solid #2196f3; border-radius: 8px;"></div>
                            <div id="encoded-label" style="margin-top: 10px; font-size: 14px;">RGB(186, 186, 186)</div>
                        </div>
                        
                        <div style="text-align: center;">
                            <div style="font-weight: bold; margin-bottom: 10px; color: #ff9800;">Display Output</div>
                            <div id="display-box" style="width: 100%; height: 120px; background: rgb(128,128,128); border: 3px solid #ff9800; border-radius: 8px;"></div>
                            <div id="display-label" style="margin-top: 10px; font-size: 14px;">RGB(128, 128, 128)</div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 30px; padding: 20px; background: #e8f5e9; border-radius: 8px; border: 2px solid #4caf50;">
                        <strong>Math Breakdown:</strong>
                        <div id="math-breakdown" style="margin-top: 10px; font-family: 'Courier New', monospace; line-height: 1.8;">
                            Linear value: 0.50<br>
                            Encoded: pow(0.50, 1/2.2) = 0.73<br>
                            Display: pow(0.73, 2.2) = 0.50 ‚úì
                        </div>
                    </div>
                </div>
                
                <script>
                    const slider = document.getElementById('linear-slider');
                    const linearValueDisplay = document.getElementById('linear-value');
                    const linearBox = document.getElementById('linear-box');
                    const encodedBox = document.getElementById('encoded-box');
                    const displayBox = document.getElementById('display-box');
                    const linearLabel = document.getElementById('linear-label');
                    const encodedLabel = document.getElementById('encoded-label');
                    const displayLabel = document.getElementById('display-label');
                    const mathBreakdown = document.getElementById('math-breakdown');
                    
                    slider.addEventListener('input', function() {
                        const linearValue = this.value / 100;
                        linearValueDisplay.textContent = linearValue.toFixed(2);
                        
                        // Calculate values
                        const linearRGB = Math.round(linearValue * 255);
                        const encodedValue = Math.pow(linearValue, 1/2.2);
                        const encodedRGB = Math.round(encodedValue * 255);
                        const displayValue = Math.pow(encodedValue, 2.2);
                        const displayRGB = Math.round(displayValue * 255);
                        
                        // Update boxes
                        linearBox.style.background = `rgb(${linearRGB}, ${linearRGB}, ${linearRGB})`;
                        encodedBox.style.background = `rgb(${encodedRGB}, ${encodedRGB}, ${encodedRGB})`;
                        displayBox.style.background = `rgb(${displayRGB}, ${displayRGB}, ${displayRGB})`;
                        
                        // Update labels
                        linearLabel.textContent = `RGB(${linearRGB}, ${linearRGB}, ${linearRGB})`;
                        encodedLabel.textContent = `RGB(${encodedRGB}, ${encodedRGB}, ${encodedRGB})`;
                        displayLabel.textContent = `RGB(${displayRGB}, ${displayRGB}, ${displayRGB})`;
                        
                        // Update math
                        mathBreakdown.innerHTML = `
                            Linear value: ${linearValue.toFixed(2)}<br>
                            Encoded: pow(${linearValue.toFixed(2)}, 1/2.2) = ${encodedValue.toFixed(2)}<br>
                            Display: pow(${encodedValue.toFixed(2)}, 2.2) = ${displayValue.toFixed(2)} ${Math.abs(displayValue - linearValue) < 0.01 ? '‚úì' : ''}
                        `;
                    });
                </script>
                
                <div class="note key-fact" style="margin-top: 25px;">
                    <strong>üéØ Notice:</strong>
                    The "Display Output" should always closely match the "Linear Value" when gamma correction is properly applied. The middle value (Gamma Encoded) is brighter because we're pre-compensating for the monitor's darkening effect.
                </div>
            </div>

            <!-- sRGB and Approximations -->
            <div class="section">
                <h2>üìä sRGB and Fast Approximations</h2>
                
                <h3>The sRGB Standard</h3>
                <p style="line-height: 1.8; margin-bottom: 25px;">
                    The sRGB color space is the standard for most web content and consumer displays. It uses a slightly more complex curve than pure gamma 2.2, but for practical purposes, treating it as gamma 2.2 is usually sufficient. The actual sRGB specification has a linear segment near black to avoid numerical issues.
                </p>

                <div class="comparison-grid">
                    <div class="comparison-item">
                        <h4>Simple Gamma 2.2 (Fast)</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #c678dd;">vec3</span> <span style="color: #61afef;">toGamma</span>(<span style="color: #c678dd;">vec3</span> linear) {
    <span style="color: #c678dd;">return</span> <span style="color: #61afef;">pow</span>(linear, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.2</span>));
}</pre>
                        </div>
                        <p style="margin-top: 10px; font-size: 0.9em;">‚úì Fast, simple, good enough for most cases</p>
                    </div>
                    
                    <div class="comparison-item">
                        <h4>Accurate sRGB (Precise)</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #c678dd;">float</span> <span style="color: #61afef;">toSRGB</span>(<span style="color: #c678dd;">float</span> linear) {
    <span style="color: #c678dd;">if</span> (linear <= <span style="color: #d19a66;">0.0031308</span>)
        <span style="color: #c678dd;">return</span> linear * <span style="color: #d19a66;">12.92</span>;
    <span style="color: #c678dd;">return</span> <span style="color: #d19a66;">1.055</span> * <span style="color: #61afef;">pow</span>(linear, <span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.4</span>) 
           - <span style="color: #d19a66;">0.055</span>;
}</pre>
                        </div>
                        <p style="margin-top: 10px; font-size: 0.9em;">‚úì Exact sRGB specification</p>
                    </div>
                    
                    <div class="comparison-item">
                        <h4>Fast Approximation</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #c678dd;">vec3</span> <span style="color: #61afef;">fastGamma</span>(<span style="color: #c678dd;">vec3</span> linear) {
    <span style="color: #7f848e;">// Square root twice ‚âà ^0.5 ‚âà ^(1/2)</span>
    <span style="color: #c678dd;">return</span> <span style="color: #61afef;">sqrt</span>(<span style="color: #61afef;">sqrt</span>(linear));
}</pre>
                        </div>
                        <p style="margin-top: 10px; font-size: 0.9em;">‚ö° Very fast, approximate gamma 2.2</p>
                    </div>
                </div>

                <div class="warning-note">
                    <strong>‚ö†Ô∏è When to Use Which:</strong>
                    <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                        <li><strong>Simple gamma 2.2:</strong> Use this for most WebGL/graphics applications. It's fast and the difference from true sRGB is imperceptible in practice.</li>
                        <li><strong>Accurate sRGB:</strong> Use when you need precise color matching with calibrated displays or for professional color work.</li>
                        <li><strong>Fast approximation:</strong> Use on mobile or when performance is critical and you can tolerate slight inaccuracy.</li>
                    </ul>
                </div>
            </div>

            <!-- Implementation in Shaders -->
            <div class="section">
                <h2>üíª WebGL/GLSL Implementation</h2>
                
                <h3>Fragment Shader Example</h3>
                <p style="line-height: 1.8; margin-bottom: 25px;">
                    The most common place to apply gamma correction is at the very end of your fragment shader, just before outputting the final color. This ensures all your lighting calculations remain in linear space (physically accurate) until the final display encoding step.
                </p>

                <div class="code-section">
<pre><span style="color: #7f848e;">// Fragment Shader with Gamma Correction</span>
<span style="color: #c678dd;">precision</span> <span style="color: #c678dd;">mediump</span> <span style="color: #c678dd;">float</span>;

<span style="color: #c678dd;">varying</span> <span style="color: #c678dd;">vec3</span> vNormal;
<span style="color: #c678dd;">varying</span> <span style="color: #c678dd;">vec3</span> vPosition;

<span style="color: #c678dd;">uniform</span> <span style="color: #c678dd;">vec3</span> uLightPosition;
<span style="color: #c678dd;">uniform</span> <span style="color: #c678dd;">vec3</span> uLightColor;
<span style="color: #c678dd;">uniform</span> <span style="color: #c678dd;">vec3</span> uViewPosition;

<span style="color: #7f848e;">// Material properties</span>
<span style="color: #c678dd;">uniform</span> <span style="color: #c678dd;">vec3</span> uDiffuseColor;
<span style="color: #c678dd;">uniform</span> <span style="color: #c678dd;">vec3</span> uSpecularColor;
<span style="color: #c678dd;">uniform</span> <span style="color: #c678dd;">float</span> uShininess;

<span style="color: #7f848e;">// Gamma correction function</span>
<span style="color: #c678dd;">vec3</span> <span style="color: #61afef;">toGamma</span>(<span style="color: #c678dd;">vec3</span> linearColor) {
    <span style="color: #c678dd;">return</span> <span style="color: #61afef;">pow</span>(linearColor, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span> / <span style="color: #d19a66;">2.2</span>));
}

<span style="color: #c678dd;">void</span> <span style="color: #61afef;">main</span>() {
    <span style="color: #7f848e;">// Normalize vectors</span>
    <span style="color: #c678dd;">vec3</span> normal = <span style="color: #61afef;">normalize</span>(vNormal);
    <span style="color: #c678dd;">vec3</span> lightDir = <span style="color: #61afef;">normalize</span>(uLightPosition - vPosition);
    <span style="color: #c678dd;">vec3</span> viewDir = <span style="color: #61afef;">normalize</span>(uViewPosition - vPosition);
    <span style="color: #c678dd;">vec3</span> reflectDir = <span style="color: #61afef;">reflect</span>(-lightDir, normal);
    
    <span style="color: #7f848e;">// Ambient (constant term)</span>
    <span style="color: #c678dd;">vec3</span> ambient = <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">0.1</span>) * uDiffuseColor;
    
    <span style="color: #7f848e;">// Diffuse (Lambertian)</span>
    <span style="color: #c678dd;">float</span> diff = <span style="color: #61afef;">max</span>(<span style="color: #61afef;">dot</span>(normal, lightDir), <span style="color: #d19a66;">0.0</span>);
    <span style="color: #c678dd;">vec3</span> diffuse = diff * uLightColor * uDiffuseColor;
    
    <span style="color: #7f848e;">// Specular (Blinn-Phong)</span>
    <span style="color: #c678dd;">vec3</span> halfwayDir = <span style="color: #61afef;">normalize</span>(lightDir + viewDir);
    <span style="color: #c678dd;">float</span> spec = <span style="color: #61afef;">pow</span>(<span style="color: #61afef;">max</span>(<span style="color: #61afef;">dot</span>(normal, halfwayDir), <span style="color: #d19a66;">0.0</span>), uShininess);
    <span style="color: #c678dd;">vec3</span> specular = spec * uLightColor * uSpecularColor;
    
    <span style="color: #7f848e;">// Combine in LINEAR space (physically correct)</span>
    <span style="color: #c678dd;">vec3</span> linearColor = ambient + diffuse + specular;
    
    <span style="color: #7f848e;">// ‚≠ê CRITICAL: Apply gamma correction before output</span>
    <span style="color: #c678dd;">vec3</span> gammaColor = <span style="color: #61afef;">toGamma</span>(linearColor);
    
    <span style="color: #e5c07b;">gl_FragColor</span> = <span style="color: #c678dd;">vec4</span>(gammaColor, <span style="color: #d19a66;">1.0</span>);
}</pre>
                </div>

                <div class="key-fact">
                    <strong>üéØ Key Points:</strong>
                    <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                        <li><strong>Do all lighting math in linear space</strong> - This ensures physically accurate light interaction</li>
                        <li><strong>Apply gamma correction as the LAST step</strong> - Convert from linear to gamma-encoded only when outputting</li>
                        <li><strong>Don't gamma-correct twice!</strong> - If using sRGB textures, you may need to convert them to linear first (more on this below)</li>
                        <li><strong>Use the same gamma for all channels</strong> - RGB should all use the same gamma value</li>
                    </ul>
                </div>

                <h3>Complete WebGL Application Pattern</h3>
                <div class="code-section">
<pre><span style="color: #7f848e;">// JavaScript - WebGL Setup with Gamma Correction</span>

<span style="color: #7f848e;">// 1. Enable sRGB framebuffer (preferred method if supported)</span>
<span style="color: #c678dd;">const</span> gl = canvas.<span style="color: #61afef;">getContext</span>(<span style="color: #98c379;">'webgl2'</span>);

<span style="color: #7f848e;">// Check for sRGB extension</span>
<span style="color: #c678dd;">const</span> ext = gl.<span style="color: #61afef;">getExtension</span>(<span style="color: #98c379;">'EXT_sRGB'</span>);
<span style="color: #c678dd;">if</span> (ext) {
    <span style="color: #7f848e;">// Enable automatic gamma correction</span>
    gl.<span style="color: #61afef;">enable</span>(gl.<span style="color: #e06c75;">FRAMEBUFFER_SRGB</span>);
    <span style="color: #e5c07b;">console</span>.<span style="color: #61afef;">log</span>(<span style="color: #98c379;">'sRGB framebuffer enabled - automatic gamma!'</span>);
} <span style="color: #c678dd;">else</span> {
    <span style="color: #7f848e;">// Fall back to manual gamma correction in shader</span>
    <span style="color: #e5c07b;">console</span>.<span style="color: #61afef;">log</span>(<span style="color: #98c379;">'Using manual gamma correction'</span>);
}

<span style="color: #7f848e;">// 2. When loading textures that are in sRGB (most images)</span>
<span style="color: #c678dd;">function</span> <span style="color: #61afef;">loadTexture</span>(gl, url) {
    <span style="color: #c678dd;">const</span> texture = gl.<span style="color: #61afef;">createTexture</span>();
    <span style="color: #c678dd;">const</span> image = <span style="color: #c678dd;">new</span> <span style="color: #e5c07b;">Image</span>();
    
    image.<span style="color: #e06c75;">onload</span> = <span style="color: #c678dd;">function</span>() {
        gl.<span style="color: #61afef;">bindTexture</span>(gl.<span style="color: #e06c75;">TEXTURE_2D</span>, texture);
        
        <span style="color: #7f848e;">// Upload texture</span>
        gl.<span style="color: #61afef;">texImage2D</span>(
            gl.<span style="color: #e06c75;">TEXTURE_2D</span>, 
            <span style="color: #d19a66;">0</span>, 
            gl.<span style="color: #e06c75;">RGBA</span>,  <span style="color: #7f848e;">// or use gl.SRGB8_ALPHA8 in WebGL2</span>
            gl.<span style="color: #e06c75;">RGBA</span>, 
            gl.<span style="color: #e06c75;">UNSIGNED_BYTE</span>, 
            image
        );
        
        gl.<span style="color: #61afef;">texParameteri</span>(gl.<span style="color: #e06c75;">TEXTURE_2D</span>, gl.<span style="color: #e06c75;">TEXTURE_MIN_FILTER</span>, gl.<span style="color: #e06c75;">LINEAR</span>);
        gl.<span style="color: #61afef;">texParameteri</span>(gl.<span style="color: #e06c75;">TEXTURE_2D</span>, gl.<span style="color: #e06c75;">TEXTURE_MAG_FILTER</span>, gl.<span style="color: #e06c75;">LINEAR</span>);
    };
    
    image.<span style="color: #e06c75;">src</span> = url;
    <span style="color: #c678dd;">return</span> texture;
}

<span style="color: #7f848e;">// 3. In your fragment shader, convert sRGB textures to linear</span>
<span style="color: #7f848e;">// (if not using automatic sRGB conversion)</span>
<span style="color: #c678dd;">const</span> fragmentShaderSource = <span style="color: #98c379;">`
    precision mediump float;
    
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    
    // Convert sRGB texture sample to linear
    vec3 toLinear(vec3 srgbColor) {
        return pow(srgbColor, vec3(2.2));
    }
    
    // Convert linear to gamma for output
    vec3 toGamma(vec3 linearColor) {
        return pow(linearColor, vec3(1.0 / 2.2));
    }
    
    void main() {
        // Sample texture (in sRGB)
        vec3 texColor = texture2D(uTexture, vTexCoord).rgb;
        
        // Convert to linear for lighting calculations
        vec3 linearColor = toLinear(texColor);
        
        // ... do lighting calculations in linear space ...
        
        // Convert back to gamma for display
        vec3 finalColor = toGamma(linearColor);
        
        gl_FragColor = vec4(finalColor, 1.0);
    }
`</span>;</pre>
                </div>
            </div>

            <!-- Common Mistakes -->
            <div class="section">
                <h2>üö´ Common Mistakes and How to Avoid Them</h2>
                
                <div class="comparison-grid">
                    <div class="comparison-item" style="border-left: 4px solid #e74c3c;">
                        <h4 style="color: #e74c3c;">‚ùå Mistake 1: No Gamma Correction</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #7f848e;">// BAD: Output linear values directly</span>
<span style="color: #c678dd;">void</span> <span style="color: #61afef;">main</span>() {
    <span style="color: #c678dd;">vec3</span> color = <span style="color: #61afef;">calculateLighting</span>();
    <span style="color: #e5c07b;">gl_FragColor</span> = <span style="color: #c678dd;">vec4</span>(color, <span style="color: #d19a66;">1.0</span>);
}</pre>
                        </div>
                        <p style="margin-top: 10px; color: #e74c3c;"><strong>Problem:</strong> Everything looks too dark, especially midtones</p>
                    </div>
                    
                    <div class="comparison-item" style="border-left: 4px solid #4caf50;">
                        <h4 style="color: #4caf50;">‚úì Fix: Apply Gamma Encoding</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #7f848e;">// GOOD: Gamma correct before output</span>
<span style="color: #c678dd;">void</span> <span style="color: #61afef;">main</span>() {
    <span style="color: #c678dd;">vec3</span> color = <span style="color: #61afef;">calculateLighting</span>();
    color = <span style="color: #61afef;">pow</span>(color, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.2</span>));
    <span style="color: #e5c07b;">gl_FragColor</span> = <span style="color: #c678dd;">vec4</span>(color, <span style="color: #d19a66;">1.0</span>);
}</pre>
                        </div>
                        <p style="margin-top: 10px; color: #4caf50;"><strong>Result:</strong> Proper brightness and contrast</p>
                    </div>
                    
                    <div class="comparison-item" style="border-left: 4px solid #e74c3c;">
                        <h4 style="color: #e74c3c;">‚ùå Mistake 2: Double Gamma</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #7f848e;">// BAD: Correcting already-corrected data</span>
<span style="color: #c678dd;">vec3</span> tex = <span style="color: #61afef;">texture2D</span>(uTex, uv).rgb;
tex = <span style="color: #61afef;">pow</span>(tex, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.2</span>)); <span style="color: #7f848e;">// Wrong!</span>
<span style="color: #c678dd;">vec3</span> final = tex * lighting;
final = <span style="color: #61afef;">pow</span>(final, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.2</span>));</pre>
                        </div>
                        <p style="margin-top: 10px; color: #e74c3c;"><strong>Problem:</strong> Image looks washed out, too bright</p>
                    </div>
                    
                    <div class="comparison-item" style="border-left: 4px solid #4caf50;">
                        <h4 style="color: #4caf50;">‚úì Fix: Correct Once, At End</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #7f848e;">// GOOD: Work in linear, correct once</span>
<span style="color: #c678dd;">vec3</span> tex = <span style="color: #61afef;">pow</span>(<span style="color: #61afef;">texture2D</span>(uTex,uv).rgb, 
              <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">2.2</span>)); <span style="color: #7f848e;">// to linear</span>
<span style="color: #c678dd;">vec3</span> final = tex * lighting;
final = <span style="color: #61afef;">pow</span>(final, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.2</span>));</pre>
                        </div>
                        <p style="margin-top: 10px; color: #4caf50;"><strong>Result:</strong> Correct colors and brightness</p>
                    </div>
                    
                    <div class="comparison-item" style="border-left: 4px solid #e74c3c;">
                        <h4 style="color: #e74c3c;">‚ùå Mistake 3: Mixing Spaces</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #7f848e;">// BAD: Blending in gamma space</span>
<span style="color: #c678dd;">vec3</span> color1 = <span style="color: #61afef;">pow</span>(c1, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.2</span>));
<span style="color: #c678dd;">vec3</span> color2 = <span style="color: #61afef;">pow</span>(c2, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.2</span>));
<span style="color: #c678dd;">vec3</span> blended = <span style="color: #61afef;">mix</span>(color1, color2, <span style="color: #d19a66;">0.5</span>);</pre>
                        </div>
                        <p style="margin-top: 10px; color: #e74c3c;"><strong>Problem:</strong> Colors don't blend correctly</p>
                    </div>
                    
                    <div class="comparison-item" style="border-left: 4px solid #4caf50;">
                        <h4 style="color: #4caf50;">‚úì Fix: Blend in Linear Space</h4>
                        <div class="code-section" style="padding: 15px; font-size: 0.85em;">
<pre style="margin: 0;"><span style="color: #7f848e;">// GOOD: Blend linear, correct once</span>
<span style="color: #c678dd;">vec3</span> blended = <span style="color: #61afef;">mix</span>(c1, c2, <span style="color: #d19a66;">0.5</span>);
blended = <span style="color: #61afef;">pow</span>(blended, <span style="color: #c678dd;">vec3</span>(<span style="color: #d19a66;">1.0</span>/<span style="color: #d19a66;">2.2</span>));
<span style="color: #e5c07b;">gl_FragColor</span> = <span style="color: #c678dd;">vec4</span>(blended, <span style="color: #d19a66;">1.0</span>);</pre>
                        </div>
                        <p style="margin-top: 10px; color: #4caf50;"><strong>Result:</strong> Physically correct blending</p>
                    </div>
                </div>

                <div class="warning-note" style="margin-top: 25px;">
                    <strong>üéØ Golden Rule:</strong>
                    <strong>Always work in linear space, gamma correct only at the final output step.</strong> Think of gamma correction as a display format, not a computation format. You wouldn't do math in JPEG-compressed values, and you shouldn't do lighting math in gamma-corrected values either.
                </div>
            </div>

            <!-- Visual Comparison -->
            <div class="section">
                <h2>üëÅÔ∏è Visual Comparison: Before and After</h2>
                
                <svg viewBox="0 0 1400 900" xmlns="http://www.w3.org/2000/svg">
                    <!-- Background -->
                    <rect width="1400" height="900" fill="white"/>
                    
                    <!-- Title -->
                    <text x="700" y="40" font-size="28" font-weight="bold" fill="#333" text-anchor="middle">Impact of Gamma Correction on Rendered Scene</text>
                    
                    <!-- Without Gamma Correction -->
                    <g transform="translate(50, 80)">
                        <rect x="0" y="0" width="620" height="750" fill="#f0f0f0" stroke="#e74c3c" stroke-width="4" rx="10"/>
                        <text x="310" y="40" font-size="22" font-weight="bold" fill="#e74c3c" text-anchor="middle">‚ùå Without Gamma Correction</text>
                        
                        <!-- Gradient sphere (too dark) -->
                        <circle cx="310" cy="240" r="140" fill="url(#gradient-dark)" stroke="#333" stroke-width="3"/>
                        
                        <!-- Gradient bar -->
                        <rect x="60" y="430" width="500" height="60" fill="url(#linear-gradient)"/>
                        <text x="310" y="510" font-size="14" fill="#666" text-anchor="middle">Linear gradient (0.0 to 1.0)</text>
                        
                        <!-- Sample boxes -->
                        <g transform="translate(60, 550)">
                            <rect x="0" y="0" width="90" height="90" fill="rgb(0,0,0)"/>
                            <text x="45" y="110" font-size="12" fill="#333" text-anchor="middle">0.00</text>
                            
                            <rect x="105" y="0" width="90" height="90" fill="rgb(64,64,64)"/>
                            <text x="150" y="110" font-size="12" fill="#333" text-anchor="middle">0.25</text>
                            <text x="150" y="125" font-size="11" fill="#e74c3c" text-anchor="middle" font-weight="bold">Too dark!</text>
                            
                            <rect x="210" y="0" width="90" height="90" fill="rgb(128,128,128)"/>
                            <text x="255" y="110" font-size="12" fill="#333" text-anchor="middle">0.50</text>
                            <text x="255" y="125" font-size="11" fill="#e74c3c" text-anchor="middle" font-weight="bold">Way too dark!</text>
                            
                            <rect x="315" y="0" width="90" height="90" fill="rgb(191,191,191)"/>
                            <text x="360" y="110" font-size="12" fill="#333" text-anchor="middle">0.75</text>
                            
                            <rect x="420" y="0" width="90" height="90" fill="rgb(255,255,255)"/>
                            <text x="465" y="110" font-size="12" fill="#333" text-anchor="middle">1.00</text>
                        </g>
                        
                        <text x="310" y="700" font-size="15" fill="#e74c3c" text-anchor="middle" font-weight="bold">Problems:</text>
                        <text x="310" y="720" font-size="13" fill="#666" text-anchor="middle">‚Ä¢ Midtones appear as shadows</text>
                        <text x="310" y="740" font-size="13" fill="#666" text-anchor="middle">‚Ä¢ Loss of detail in dark areas</text>
                    </g>
                    
                    <!-- With Gamma Correction -->
                    <g transform="translate(730, 80)">
                        <rect x="0" y="0" width="620" height="750" fill="#f0f0f0" stroke="#4caf50" stroke-width="4" rx="10"/>
                        <text x="310" y="40" font-size="22" font-weight="bold" fill="#4caf50" text-anchor="middle">‚úì With Gamma Correction</text>
                        
                        <!-- Gradient sphere (correct) -->
                        <circle cx="310" cy="240" r="140" fill="url(#gradient-light)" stroke="#333" stroke-width="3"/>
                        
                        <!-- Gradient bar -->
                        <rect x="60" y="430" width="500" height="60" fill="url(#gamma-gradient)"/>
                        <text x="310" y="510" font-size="14" fill="#666" text-anchor="middle">Gamma-corrected gradient</text>
                        
                        <!-- Sample boxes -->
                        <g transform="translate(60, 550)">
                            <rect x="0" y="0" width="90" height="90" fill="rgb(0,0,0)"/>
                            <text x="45" y="110" font-size="12" fill="#333" text-anchor="middle">0.00</text>
                            
                            <rect x="105" y="0" width="90" height="90" fill="rgb(137,137,137)"/>
                            <text x="150" y="110" font-size="12" fill="#333" text-anchor="middle">0.25</text>
                            <text x="150" y="125" font-size="11" fill="#4caf50" text-anchor="middle" font-weight="bold">Perfect! ‚úì</text>
                            
                            <rect x="210" y="0" width="90" height="90" fill="rgb(188,188,188)"/>
                            <text x="255" y="110" font-size="12" fill="#333" text-anchor="middle">0.50</text>
                            <text x="255" y="125" font-size="11" fill="#4caf50" text-anchor="middle" font-weight="bold">Perfect! ‚úì</text>
                            
                            <rect x="315" y="0" width="90" height="90" fill="rgb(221,221,221)"/>
                            <text x="360" y="110" font-size="12" fill="#333" text-anchor="middle">0.75</text>
                            
                            <rect x="420" y="0" width="90" height="90" fill="rgb(255,255,255)"/>
                            <text x="465" y="110" font-size="12" fill="#333" text-anchor="middle">1.00</text>
                        </g>
                        
                        <text x="310" y="700" font-size="15" fill="#4caf50" text-anchor="middle" font-weight="bold">Benefits:</text>
                        <text x="310" y="720" font-size="13" fill="#666" text-anchor="middle">‚Ä¢ Proper midtone reproduction</text>
                        <text x="310" y="740" font-size="13" fill="#666" text-anchor="middle">‚Ä¢ More visible detail throughout</text>
                    </g>
                    
                    <!-- Gradient definitions -->
                    <defs>
                        <!-- Dark gradient (without gamma correction) -->
                        <radialGradient id="gradient-dark">
                            <stop offset="0%" style="stop-color:rgb(255,255,255);stop-opacity:1" />
                            <stop offset="40%" style="stop-color:rgb(128,128,128);stop-opacity:1" />
                            <stop offset="100%" style="stop-color:rgb(0,0,0);stop-opacity:1" />
                        </radialGradient>
                        
                        <!-- Light gradient (with gamma correction) -->
                        <radialGradient id="gradient-light">
                            <stop offset="0%" style="stop-color:rgb(255,255,255);stop-opacity:1" />
                            <stop offset="40%" style="stop-color:rgb(188,188,188);stop-opacity:1" />
                            <stop offset="100%" style="stop-color:rgb(0,0,0);stop-opacity:1" />
                        </radialGradient>
                        
                        <!-- Linear gradient -->
                        <linearGradient id="linear-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:rgb(0,0,0);stop-opacity:1" />
                            <stop offset="25%" style="stop-color:rgb(64,64,64);stop-opacity:1" />
                            <stop offset="50%" style="stop-color:rgb(128,128,128);stop-opacity:1" />
                            <stop offset="75%" style="stop-color:rgb(191,191,191);stop-opacity:1" />
                            <stop offset="100%" style="stop-color:rgb(255,255,255);stop-opacity:1" />
                        </linearGradient>
                        
                        <!-- Gamma-corrected gradient -->
                        <linearGradient id="gamma-gradient" x1="0%" y1="0%" x2="100%" y2="0%">
                            <stop offset="0%" style="stop-color:rgb(0,0,0);stop-opacity:1" />
                            <stop offset="25%" style="stop-color:rgb(137,137,137);stop-opacity:1" />
                            <stop offset="50%" style="stop-color:rgb(188,188,188);stop-opacity:1" />
                            <stop offset="75%" style="stop-color:rgb(221,221,221);stop-opacity:1" />
                            <stop offset="100%" style="stop-color:rgb(255,255,255);stop-opacity:1" />
                        </linearGradient>
                    </defs>
                </svg>
                
                <div class="key-fact" style="margin-top: 25px;">
                    <strong>üëÅÔ∏è What You Should See:</strong>
                    On the left (without gamma correction), notice how the sphere loses detail in the darker regions and appears too dark overall. The 50% gray box looks much darker than middle gray. On the right (with gamma correction), the sphere has better detail throughout, and the 50% gray actually looks like 50% brightness. The difference is especially noticeable in midtones.
                </div>
            </div>

            <!-- Summary -->
            <div class="section">
                <h2>üìã Summary and Quick Reference</h2>
                
                <div class="key-fact">
                    <strong>üéì Key Takeaways:</strong>
                    <ol style="margin: 10px 0 0 20px; line-height: 2;">
                        <li><strong>Monitors are non-linear:</strong> A value of 0.5 displays at ~22% brightness due to gamma 2.2 response</li>
                        <li><strong>Do lighting in linear space:</strong> Physically-based rendering requires linear math</li>
                        <li><strong>Gamma correct at the end:</strong> Apply pow(color, 1/2.2) before output</li>
                        <li><strong>sRGB textures need conversion:</strong> Convert sRGB textures to linear before lighting calculations</li>
                        <li><strong>Correct only once:</strong> Never apply gamma correction multiple times</li>
                        <li><strong>Simple gamma 2.2 is enough:</strong> For most applications, pow(color, 1/2.2) is sufficient</li>
                    </ol>
                </div>

                <h3 style="margin-top: 30px;">Quick Reference Formulas</h3>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-top: 20px;">
                    <div class="formula-box">
                        <div class="label">Linear to Gamma (Encoding):</div>
                        <div style="color: #2196f3;">gamma = linear<sup>1/2.2</sup></div>
                        <div style="color: #2196f3; margin-top: 10px;">gamma = linear<sup>0.4545</sup></div>
                    </div>
                    
                    <div class="formula-box">
                        <div class="label">Gamma to Linear (Decoding):</div>
                        <div style="color: #ff9800;">linear = gamma<sup>2.2</sup></div>
                    </div>
                </div>

                <h3 style="margin-top: 30px;">When to Apply Gamma Correction</h3>
                <table style="margin-top: 15px;">
                    <thead>
                        <tr>
                            <th>Situation</th>
                            <th>Action Required</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Outputting final color from fragment shader</td>
                            <td>‚úì Apply gamma encoding (pow 1/2.2)</td>
                        </tr>
                        <tr>
                            <td>Loading sRGB texture (jpg, png)</td>
                            <td>‚úì Convert to linear (pow 2.2) if not automatic</td>
                        </tr>
                        <tr>
                            <td>Blending colors</td>
                            <td>‚úì Do in linear space</td>
                        </tr>
                        <tr>
                            <td>Calculating lighting</td>
                            <td>‚úì Do in linear space</td>
                        </tr>
                        <tr>
                            <td>Reading heightmap/normalmap</td>
                            <td>‚ùå Already linear data, don't convert</td>
                        </tr>
                        <tr>
                            <td>Using sRGB framebuffer extension</td>
                            <td>‚ùå Automatic, don't manually correct</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Final Note -->
            <div class="section" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
                <h2 style="color: white;">üéâ Congratulations!</h2>
                <p style="line-height: 1.8; font-size: 1.1em;">
                    You now understand gamma correction! This is one of those topics that seems complex at first but becomes second nature once you internalize the core concept: <strong>displays are non-linear, so we must pre-compensate.</strong> Implement this in your shaders, and your graphics will immediately look more professional and physically accurate.
                </p>
                <p style="line-height: 1.8; font-size: 1.1em; margin-top: 20px;">
                    Remember: <strong>Linear for calculations, gamma for display.</strong> That's the golden rule!
                </p>
            </div>
        </div>
    </div>
</body>
</html>